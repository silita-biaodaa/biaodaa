<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.silita.biaodaa.dao.NoticeMapper">
    <sql id="selectCompanyInfo">
        SELECT DISTINCT c.*
        FROM mishu.tb_company c
        WHERE 1=1
        <if test="area != null and area != ''">
            and c.`regis_address` like CONCAT(#{area},'%')
        </if>
        <if test="zzList != null and zzList.size() > 0">
            and
            <foreach collection="zzList" item="zz" separator=" or " open="(" close=")">
                c.`range` like '%${zz}%'
            </foreach>
        </if>


        order by length(c.`range`) desc
    </sql>

    <sql id="queryComByIds">
        select c.com_id,c.com_name,c.org_code
        from tb_company c
        where c.com_id in
        <foreach collection="comList" item="com" separator="," open="(" close=")">
            #{com.comId}
        </foreach>
    </sql>

    <select id="selectCompanyCert" resultType="com.silita.biaodaa.model.TbCompany"
            parameterType="com.silita.biaodaa.model.TbCompany">
        SELECT cc.com_id,s.cert_no,s.cert_date,s.valid_date
        FROM (
        <include refid="queryComByIds"/>
        ) cc,mishu.tb_safety_certificate s
        WHERE s.com_name =cc.com_name
    </select>

    <select id="selectCompanyCertBasic" resultType="com.silita.biaodaa.model.TbCompany"
            parameterType="com.silita.biaodaa.model.TbCompany">
        SELECT cc.com_id,b.runScope as comRange,b.registerStatus as subsist
        FROM (
        <include refid="queryComByIds"/>
        ) cc, mishu_next.cert_basic b
        WHERE b.registerNo = cc.org_code AND b.companyName = cc.com_name
    </select>

    <sql id="noticeTypeConvert">
        (case s.otherType
        when '0' then '公告'
        when '1' then '补充'
        when '2' then '答疑'
        when '3' then '流标'
        when '4' then '澄清'
        when '5' then '延期'
        when '6' then '更正公告'
        when '7' then '废标'
        when '8' then '终止'
        when '9' then '修改'
        when '10' then '控制价'
        when '11' then '资审结果'
        when '12' then '资格预审'
        when '13' then '入围'
        when '14' then '暂停'
        else '其他' end) as noticeType
        ,( case s.biddingType
        when '0' then '施工'
        when '2' then '监理'
        when '3' then '采购'
        when '1' then '设计'
        when '4' then '勘察'
        when '5' then '其他'
        else '其他' end) as projectType
    </sql>

    <sql id="noticeListHead">
        SELECT DISTINCT s.id,s.title,s.opendate,s.type,s.source
        ,
        <include refid="noticeTypeConvert"/>
        <choose>
            <when test="type==99 or type ==null or type ==''">
                <choose>
                    <when test="source==null or source=='' or source=='hunan'">
                        ,(SELECT GROUP_CONCAT(distinct dd.pbMode SEPARATOR ',') FROM mishu.zhaobiao_detail dd WHERE
                        dd.snatchurlid =s.id ) zhaobiao_pbMode
                        ,(SELECT GROUP_CONCAT(distinct dd.pbMode SEPARATOR ',') FROM mishu.zhongbiao_detail dd WHERE
                        dd.snatchurlid =s.id ) zhongbiao_pbMode
                    </when>
                    <otherwise>
                        ,(SELECT GROUP_CONCAT(distinct dd.pbMode SEPARATOR ',') FROM mishu.zhaobiao_detail_others dd
                        WHERE dd.snatchurlid =s.id and dd.source = #{source}) zhaobiao_pbMode
                        ,(SELECT GROUP_CONCAT(distinct dd.pbMode SEPARATOR ',') FROM mishu.zhongbiao_detail_others dd
                        WHERE dd.snatchurlid =s.id and dd.source = #{source}) zhongbiao_pbMode
                    </otherwise>
                </choose>
            </when>
            <otherwise>
                ,IFNULL((SELECT GROUP_CONCAT(distinct dd.pbMode SEPARATOR ',') FROM mishu.${detailTable} dd WHERE
                dd.snatchurlid =s.id
                <if test="detailTable != null and detailTable == 'zhaobiao_detail_others'">
                    and dd.source = #{source}
                </if>
                ),'其他') pbMode
            </otherwise>
        </choose>
        <choose>
            <when test="source == '' or source == null or source == 'hunan'">
                ,(SELECT GROUP_CONCAT(distinct zz.certificate SEPARATOR ',') FROM mishu.snatch_url_cert zz WHERE zz.contId =s.id
                ) certificate
            </when>
            <otherwise>
                ,(SELECT GROUP_CONCAT(distinct zz.certificate SEPARATOR ',') FROM mishu.snatch_url_cert_others zz WHERE zz.contId =s.id and zz.source = #{source}
                ) certificate
            </otherwise>
        </choose>
        <if test="type == 2 or type==99  or type ==null or type ==''">
            <include refid="zhongbidaoDetailField"/>
        </if>
    </sql>

    <sql id="noticeListBaseFrom">
        FROM
        <choose>
            <when test="snatchurl_tbn != null and snatchurl_tbn != ''">
                ${snatchurl_tbn} s
            </when>
            <otherwise>
                mishu.snatchurl s
            </otherwise>
        </choose>
    </sql>

    <sql id="noticeListTail">
        and DATE_ADD(now(),INTERVAL -${queryDays} DAY) &lt; s.openDate
        <if test="aptMapList==null or aptMapList.size()==0">
            order by s.openDate desc,s.edit desc,s.biddingType ASC,s.id desc
        </if>
    </sql>

    <sql id="zhongbidaoDetailField">
        <!-- 中标列表多标段信息 --><!--
        ,(SELECT GROUP_CONCAT(distinct dd.oneName SEPARATOR ',')  FROM mishu.zhongbiao_detail dd WHERE dd.snatchurlid =s.id ) oneName
        ,(SELECT GROUP_CONCAT(distinct dd.projSum SEPARATOR ',')  FROM mishu.zhongbiao_detail dd WHERE dd.snatchurlid =s.id ) projSum-->
        <!-- 中标列表多标段公告只显示第一标段信息 -->
        ,(SELECT outdd.oneName from mishu.${detailTable} outdd where outdd.id =(SELECT min(dd.id) FROM
        mishu.${detailTable} dd WHERE dd.snatchurlid =s.id
        <if test="detailTable != null and detailTable == 'zhongbiao_detail_others'">
            and dd.source = #{source}
        </if>
        )) oneName
        ,(SELECT outdd.projSum from mishu.${detailTable} outdd where outdd.id =(SELECT min(dd.id) FROM
        mishu.${detailTable} dd WHERE dd.snatchurlid =s.id
        <if test="detailTable != null and detailTable == 'zhongbiao_detail_others'">
            and dd.source = #{source}
        </if>
        )) projSum
        ,(SELECT outdd.oneOffer from mishu.${detailTable} outdd where outdd.id =(SELECT min(dd.id) FROM
        mishu.${detailTable} dd WHERE dd.snatchurlid =s.id
        <if test="detailTable != null and detailTable == 'zhongbiao_detail_others'">
            and dd.source = #{source}
        </if>
        )) oneOffer
    </sql>

    <select id="queryNoticeCollStatus" parameterType="Map" resultType="Long">
        SELECT co.noticeid
        FROM mishu_write.collec_notice co
        WHERE co.noticeid IN
        <foreach collection="idSet" item="noticeId" open="(" close=")" separator=",">
            #{noticeId}
        </foreach>
        AND userid=#{userId}
    </select>


    <select id="queryCompanyCollStatus" parameterType="Map" resultType="java.lang.String">
        SELECT cc.companyId
        FROM mishu_write.colle_company_new cc
        WHERE cc.companyId IN
        <foreach collection="idSet" item="id" open="(" close=")" separator=",">
            #{id}
        </foreach>
        AND userid=#{userId}
    </select>


    <select id="queryNoticesByCompanyName" resultType="Long" parameterType="String">
        SELECT a.contId
        FROM mishu.snatch_url_cert a
        WHERE a.certificateUuid in (
        SELECT cz.zhuuid
        FROM mishu.cert_zz cz
        join mishu.cert_src cs  on cz.srcUuid=cs.uuid
        where cs.companyName=#{companyName} and zhuuid is not null
        )
    </select>

    <select id="searchNoticeList" resultType="Map" parameterType="Map">
        <include refid="noticeListHead"/>
        <include refid="noticeListBaseFrom"/>
        WHERE s.isShow = 0
        <if test="projectType !=null and projectType!=''">
            and s.biddingType =#{projectType}
        </if>
        <if test="province !=null and province !=''">
            and s.province =(select name_abbr from mishu.area ar where ar.name = #{province} and grade=0)
        </if>
        <if test="city !=null and city !=''">
            and s.city in(select name_abbr from mishu.area where display_name like '%${city}%')
        </if>
        <if test="search !=null and search !=''">
            AND s.title LIKE '%${search}%'
        </if>
        <choose>
            <when test="type==99">
                and (s.type =0 or s.type=2)
            </when>
            <otherwise>
                and s.type = #{type}
            </otherwise>
        </choose>
        <include refid="noticeListTail"/>
    </select>

    <select id="queryNoticeList" resultType="Map" parameterType="Map">
        <include refid="noticeListHead"/>
        <!--报名地点 -->
        <!--<if test="type==0 and bmSiteStr !=null and bmSiteStr!=''">-->
        <!--,detail.bmSite-->
        <!--</if>-->
        <include refid="noticeListBaseFrom"/>
        <!--资质筛选 -->
        <if test=" (comThreeAptList !=null and comThreeAptList !='') or (aptMapList!=null and aptMapList.size()>0) or (zzTypeOneList != null and zzTypeOneList.size()>0)">
            <choose>
                <when test="source == '' or source == null or source == 'hunan'">
                    join mishu.snatch_url_cert suc on suc.contId=s.id
                </when>
                <otherwise>
                    join mishu.snatch_url_cert_others suc on suc.contId=s.id and suc.source = #{source}
                </otherwise>
            </choose>
            <!-- 企业匹配的三级资质 -->
            <if test="comThreeAptList !=null and comThreeAptList !=''">
                and (
                <foreach collection="comThreeAptList" item="comThreeApt" separator=" or ">
                    suc.certificateuuid like CONCAT('%',#{comThreeApt},'%')
                </foreach>
                )
            </if>

            <if test="aptMapList!=null and aptMapList.size() > 0">
                and (
                <!--筛选选择的资质 -->
                <foreach collection="aptMapList" item="aptMap" separator=" or " open="(" close=")">
                    <choose>
                        <when test="aptMap.containsKey('threeAptList')">
                            <!--**及以上 -->
                            <foreach collection="aptMap.get('threeAptList')" item="zzTypeThree" open="(" close=")"
                                     separator=" or ">
                                suc.certificateuuid like CONCAT('%',#{zzTypeThree},'%')
                            </foreach>
                            <!--**及以上 排除下级资质-->
                            <foreach collection="aptMap.get('notThreeAptList')" item="notThreeApt">
                                and suc.certificateuuid not like CONCAT('%',#{notThreeApt},'%')
                            </foreach>
                        </when>
                        <when test="aptMap.containsKey('zzTypeTwo')">
                            suc.certificateuuid like '%${aptMap.get("zzTypeTwo")}%'
                        </when>
                    </choose>
                </foreach>
                )
            </if>

            <if test="zzTypeOneList != null and zzTypeOneList.size()>0">
                join (select distinct majoruuid as majorUuid
                from mishu.aptitude_dictionary
                where
                <foreach collection="zzTypeOneList" item="zzTypeOne" separator=" or ">
                    aptitudeCode=#{zzTypeOne}
                </foreach>
                ) zzdic on locate(zzdic.majorUuid,suc.certificateUuid)>0
            </if>
            <if test=" ( oneName !=null and oneName !='') or (type==0 and bmSiteStr !=null and bmSiteStr!='') or (modeStr !=null and modeStr!='') or (projSumStart !=null and projSumStart!='') or (projSumEnd !=null and projSumEnd !='') or (kbDateStart !=null and kbDateStart !='') or ( kbDateEnd !=null and kbDateEnd !='') or (county != null and county != '')">
                join mishu.${detailTable} detail on s.id=detail.snatchurlid
                <!--<if test="regions !=null and regions !=''" > 维度地区信息不准-->
                <!--and(-->
                <!--<foreach item = "dq" index="index" collection = "regions" separator=" or ">-->
                <!--<if test="dq!=null and dq!=''">-->
                <!--detail.projDq like '%${dq}%'-->
                <!--</if>-->
                <!--</foreach>-->
                <!--)-->
                <!--</if>-->

                <if test="type==0">
                    <!--报名地址-->
                    <if test="bmSiteStr!=null and bmSiteStr!=''">
                        <choose>
                            <when test="bmSite==2">
                                AND LENGTH(detail.bmSite)>1 AND detail.bmSite not like '%网上%'
                            </when>
                            <otherwise>
                                AND detail.bmSite like #{bmSiteStr}
                            </otherwise>
                        </choose>
                    </if>
                </if>

                <!--评标办法 -->
                <if test="modeStr != null and modeStr.size() > 0">
                    AND
                    <foreach collection="modeStr" item="list" close=")" separator="or" open="(">
                        <!--<if test="list == '其他'">-->
                        <!--(detail.pbMode is null or detail.pbMode = '') and s.edit = 1-->
                        <!--</if>-->
                        <!--<if test="list != '其他'">-->
                        <!--detail.pbMode = #{list}-->
                        <!--</if>-->
                        <choose>
                            <when test="list == '其他'">
                                detail.pbMode is null or detail.pbMode = ''
                                or detail.pbMode = '平江县土石方工程评标定标办法'
                                or detail.pbMode = '/'
                            </when>
                            <otherwise>
                                detail.pbMode = #{list}
                            </otherwise>
                        </choose>
                    </foreach>
                </if>
                <if test="(projSumStart !=null and projSumStart!='')">
                    <choose>
                        <when test="sumType == 'zhongbiao'">
                            AND detail.oneOffer &gt;= #{projSumStart}
                        </when>
                        <otherwise>
                            AND detail.projSum &gt;= #{projSumStart}
                        </otherwise>
                    </choose>
                </if>
                <if test="(projSumEnd !=null and projSumEnd!='')">
                    <choose>
                        <when test="sumType == 'zhongbiao'">
                            AND detail.oneOffer &lt;= #{projSumEnd}
                        </when>
                        <otherwise>
                            and detail.projSum &lt;= #{projSumEnd}
                        </otherwise>
                    </choose>
                </if>
                <if test="(kbDateStart !=null and kbDateStart !='')">
                    AND detail.tbEndDate &gt;= #{kbDateStart}
                </if>
                <if test="( kbDateEnd !=null and kbDateEnd !='')">
                    AND detail.tbEndDate &lt;= #{kbDateEnd}
                </if>
                <!--中标第一候选人(企业名称)-->
                <if test="( oneName !=null and oneName !='')">
                    AND detail.oneName = #{oneName}
                </if>
            </if>
        </if>
        WHERE s.isShow = 0
        <if test="projectType !=null and projectType!=''">
            AND s.biddingType =#{projectType}
        </if>
        <!--省份判断祛除，不同省按不同表区分 -->
        <!--<if test="province !=null and province !=''" >-->
        <!--and s.province =(select name_abbr from mishu.area ar where ar.name LIKE '${province}%'  and grade=0)-->
        <!--</if>-->
        <if test="city !=null and city.size() > 0">
            AND s.city in(
            select name_abbr from mishu.area where 1=1 and
            <foreach collection="city" item="list" open="(" separator="or" close=")">
                name like CONCAT(#{list},'%')
            </foreach>
            )
        </if>
        <if test="county != null and county != ''">
            AND
            (
            detail.projXs like CONCAT(#{county},'%') or
            s.county = (select name_abbr from mishu.area where display_name like CONCAT(#{county},'%'))
            )
        </if>
        <if test="title !=null and title !=''">
            AND s.title LIKE CONCAT('%',#{title},'%')
        </if>
        <if test="(projSumStart !=null and projSumStart!='') or (projSumEnd !=null and projSumEnd!='')">
            <choose>
                <when test="sumType == 'zhongbiao'">
                    AND !(detail.oneOffer REGEXP '[^0-9.]') AND detail.oneOffer !=''
                </when>
                <otherwise>
                    AND !(detail.projSum REGEXP '[^0-9.]') AND detail.projSum !=''
                </otherwise>
            </choose>
        </if>
        <choose>
            <when test="type==99">
                and (s.type =0 or s.type=2)
            </when>
            <otherwise>
                and s.type = #{type}
            </otherwise>
        </choose>
        <choose>
            <when test="detailType == null or detailType == ''">
                <include refid="noticeListTail"/>
            </when>
            <otherwise>
                order by opendate desc
            </otherwise>
        </choose>
    </select>

    <select id="queryNoticeDetail" resultType="Map" parameterType="Map">
        SELECT s.id,s.title,s.opendate,s.type,#{source} as source
        ,
        <include refid="noticeTypeConvert"/>
        ,s.url,
        concat(#{provName},IFNULL(concat('-',IFNULL(dl.projdq,aa.name)),''),IFNULL(concat('-',dl.projXs),'')) as
        projDq,dl.pbMode,dl.projSum,
        <if test="type == 0">
            dl.bmSite,dl.kbSite,dl.kbStaffAsk,
            (SELECT GROUP_CONCAT(zz.certificate SEPARATOR ',') FROM mishu.snatch_url_cert zz WHERE zz.contId
            =#{id}) zzRank,
            dl.tbAssureEndDate,
            dl.tbAssureEndTime,dl.tbAssureSum,dl.bmEndDate,dl.bmEndTime,dl.bmSite,
            dl.tbEndDate as kbDate,dl.tbEndTime as kbTime,dl.kbSite,dl.kbStaffAsk,
        </if>
        <if test="type == 2">
            dl.oneName,dl.oneOffer,dl.twoName,dl.twoOffer,dl.threeName,dl.threeOffer,
        </if>
        dl.block,
        sc.content
        <include refid="noticeListBaseFrom"/>
        left join
        <choose>
            <when test="snatchurlcontent_tbn != null and snatchurlcontent_tbn != ''">
                ${snatchurlcontent_tbn} sc
            </when>
            <otherwise>
                mishu.snatchurlcontent sc
            </otherwise>
        </choose>
        on sc.snatchurlid=s.id
        left join mishu.${detailTable} dl on dl.snatchurlid=s.id
        left join mishu.area aa on aa.name_abbr=s.city and aa.grade=1
        where s.type = #{type} and s.isshow=0 and s.id=#{id}
    </select>

    <select id="queryRelCount" resultType="Long" parameterType="Long">
        select count(a.id)
        FROM (
        <include refid="relationNotices"/>
        ) a
    </select>

    <sql id="relationNotices">
        select DISTINCT id
         from mishu.snatchurl
         join ((select re.nextid as reid
                 from mishu.snatchrelation re
                 where re.mainid=#{id})
                  union all
                 (select mainid as reid
                 from mishu.snatchrelation re
                 where re.nextid=#{id})) rd on rd.reid=id
        WHERE isshow=0
    </sql>

    <select id="queryRelations" resultType="Map" parameterType="Long">
        <include refid="noticeListHead"/>
        <include refid="noticeListBaseFrom"/>
        join (
        <include refid="relationNotices"/>
        ) rd on rd.id=s.id
        WHERE s.isshow=0
        order by s.id desc,s.openDate desc
    </select>

    <select id="queryNoticeZZById" resultType="String" parameterType="Map">
        SELECT group_concat(DISTINCT zz.certificateuuid separator ',') as zzlist
        FROM mishu.snatch_url_cert zz
        where zz.contid=#{id}
    </select>

    <select id="queryComInfoByZZ" resultType="com.silita.biaodaa.model.TbCompany" parameterType="Map">
        <include refid="selectCompanyInfo"></include>
    </select>

    <select id="queryCompanyCountByZZ" resultType="Integer" parameterType="java.util.Map">
        SELECT count(c.com_id)
        from mishu.tb_company c
        where 1=1
        <if test="area != null and area != ''">
            and c.`regis_address` like CONCAT(#{area},'%')
        </if>
        <if test="list != null and list.size() > 0">
            and
            <foreach collection="list" item="zz" separator=" or " open="(" close=")">
                c.`range` like CONCAT('%',#{zz},'%')
            </foreach>
        </if>
        order by length(c.`range`) desc
    </select>

    <select id="queryNoticeFile" resultType="Map" parameterType="Map">
        select *
        FROM mishu.notice_file
        where snatchurlid=#{id}
    </select>

    <select id="queryProvince" parameterType="java.util.Map" resultType="java.lang.String">
        SELECT
          (SELECT t2.display_name FROM mishu.`area` t2 WHERE t2.path = t1.`parent_id`) AS displayName
        FROM ${detailTable} t
        LEFT JOIN mishu.`area` t1 ON t.`projDq` = t1.`name`
        WHERE t.`snatchUrlId` = #{id}
        LIMIT 1
    </select>

    <select id="queryComAptitudeByName" parameterType="Map" resultType="Map">
        select com_id,`range`
        from mishu.tb_company
        where com_name = #{com_name}
    </select>

    <select id="queryMatchIntoComCount" parameterType="Map" resultType="Map">
        SELECT zz.contid,aa.title,
        (CASE aa.tbassureSum WHEN '' THEN 0 WHEN '/' THEN 0 ELSE IFNULL(aa.tbassureSum,0) END) as tbassureSum,
        aa.opendate,aa.pbmode,concat(aa.tbAssureEndDate,' ',aa.tbAssureEndTime) as tbAssureEnd,
        (select count(1)
            from mishu.tb_company tc
            join mishu.tb_company_into tci on tci.com_name=tc.com_name
            where tc.`range` regexp group_concat(DISTINCT replace(zz.certificateuuid,',','|')  separator "|")
        ) as companyCount,
        aa.url,group_concat(DISTINCT replace(zz.certificateuuid,',','|') separator "|") as 'zzlist',
        aa.projectType,aa.source
        FROM mishu.snatch_url_cert zz,
        (select dd.tbAssureSum,( case s.biddingType
                when '0' then '施工'
                when '2' then '监理'
                when '3' then '采购'
                when '1' then '设计'
                when '4' then '勘察'
                when '5' then '其他'
                else '其他' end) as projectType,s.id,s.title,s.opendate,s.url,s.source,dd.pbmode,dd.tbAssureEndDate,dd.tbAssureEndTime
            from mishu.snatchurl s
            join mishu.zhaobiao_detail dd on dd.snatchurlid=s.id
            where opendate >=#{startDay} and opendate &lt;=#{endDay} and s.type=0
            order by opendate desc) aa
        where zz.contid=aa.id
        group by zz.contid
    </select>

    <select id="queryMatchComCount" parameterType="Map" resultType="Map">
        SELECT zz.contid,aa.title,
          (CASE aa.tbassureSum WHEN '' THEN 0 WHEN '/' THEN 0 ELSE IFNULL(aa.tbassureSum,0) END) as tbassureSum,
          aa.opendate,aa.pbmode,concat(aa.tbAssureEndDate,' ',aa.tbAssureEndTime) as tbAssureEnd,
          (select count(1) from mishu.tb_company tc where tc.`range` regexp group_concat(DISTINCT replace(zz.certificateuuid,',','|')  separator "|") and tc.bak_id is null) as companyCount
          ,aa.url,group_concat(DISTINCT replace(zz.certificateuuid,',','|') separator "|") as 'zzlist'
          ,aa.projectType,aa.source
        FROM mishu.snatch_url_cert zz,
        (select dd.tbAssureSum,( case s.biddingType
            when '0' then '施工'
            when '2' then '监理'
            when '3' then '采购'
            when '1' then '设计'
            when '4' then '勘察'
            when '5' then '其他'
            else '其他' end) as projectType,s.id,s.title,s.opendate,s.url,s.source,dd.pbmode,dd.tbAssureEndDate,dd.tbAssureEndTime
            from mishu.snatchurl s
            join mishu.zhaobiao_detail dd on dd.snatchurlid=s.id
            where opendate >=#{startDay} and opendate &lt;=#{endDay} and s.type=0
            order by opendate desc) aa
        where zz.contid=aa.id
        group by zz.contid
    </select>

    <insert id="inertMatchComCount" parameterType="Map">
     insert INTO biaodaa_stat.notic_match_com_report(
         cont_id,title,tb_assure_sum,
         tbAssureEnd,pb_mode,
         open_date,match_com_count,
         url,certificate_uuid,
         project_type,source,
         com_type,batchNum
     )values(
      #{contid},
      #{title},
      #{tbassureSum},
      #{tbAssureEnd},
      #{pbmode},
      #{opendate},
      #{companyCount},
      #{url},
      #{zzlist},
      #{projectType},
      #{source},
      #{comType},
      #{batchNum}
     )
    </insert>
</mapper>